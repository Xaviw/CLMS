{"version":3,"sources":["./src/app/pages/course-detail/course-detail.component.ts","./src/app/pages/course-detail/course-detail.component.html","./src/app/pages/course-detail/course-detail.module.ts"],"names":[],"mappings":"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","file":"src_app_pages_course-detail_course-detail_module_ts.js","sourcesContent":["import { ScheduleComponent } from './../../shared/components/schedule/schedule.component';\r\nimport { UserManageComponent } from './../user-manage/user-manage.component';\r\nimport { AddCourseComponent } from './../../shared/components/add-course/add-course.component';\r\nimport { CourseManageService } from './../course-manage/course-manage.service';\r\nimport { CourseDetailInfo, User, CourseAddInfo } from '@app/shared/types/commonTypes';\r\nimport { Component, OnInit, EventEmitter, ViewChild, ViewContainerRef, TemplateRef } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { NzModalService } from 'ng-zorro-antd/modal';\r\nimport { UploadDrawerComponent } from '@app/shared/components/upload-drawer/upload-drawer.component';\r\nimport { CacheService } from '@app/core/services/cache.service';\r\nimport { isEqual } from '@app/shared/utils/utils';\r\nimport { NzMessageService } from 'ng-zorro-antd/message';\r\n\r\n@Component({\r\n  selector: 'app-course-detail',\r\n  templateUrl: './course-detail.component.html',\r\n  styleUrls: ['./course-detail.component.scss'],\r\n  providers: [CourseManageService],\r\n})\r\nexport class CourseDetailComponent implements OnInit {\r\n  @ViewChild('addCourseEl') addCourseEl!: AddCourseComponent;\r\n  @ViewChild('scheduleEl') scheduleEl!: ScheduleComponent;\r\n  @ViewChild('uploadDrawerEl') uploadDrawerEl!: UploadDrawerComponent;\r\n  studentList: User[] = [];\r\n  checked: boolean = false;\r\n  indeterminate: boolean = false;\r\n  setOfCheckedId = new Set<string>(); // 已选中集合\r\n  // 课表参数\r\n  params!: { courseId: string; weekTime: number };\r\n  editable = false; // 启用编辑\r\n  detailInfo!: CourseDetailInfo; // 课程信息\r\n  // 添加学生Modal\r\n  addStudent = {\r\n    instance: <any>null,\r\n    modalInstance: <any>null,\r\n    create: (tplFooter: TemplateRef<{}>) => {\r\n      this.addStudent.modalInstance = this.modal.create({\r\n        nzTitle: '选择学生',\r\n        nzWidth: '90%',\r\n        nzBodyStyle: {\r\n          height: window.innerHeight * 0.7 + 'px',\r\n          overflow: 'auto',\r\n        },\r\n        nzContent: UserManageComponent,\r\n        nzComponentParams: {\r\n          checkMode: true,\r\n          defaultChecked: this.studentList.map((item) => item.account),\r\n        },\r\n        nzMaskClosable: false,\r\n        nzViewContainerRef: this.viewContainerRef,\r\n        nzFooter: tplFooter,\r\n      });\r\n      const instance = this.addStudent.modalInstance.getContentComponent();\r\n      this.addStudent.instance = instance;\r\n    },\r\n    handleOk: () => {\r\n      this.service\r\n        .addCourseStudent({\r\n          course_id: this.params.courseId,\r\n          user_id: Array.from(this.addStudent.instance.setOfCheckedId),\r\n        })\r\n        .subscribe((res) => {\r\n          this.addStudent.modalInstance.destroy();\r\n          this.getCourseStudent();\r\n        });\r\n    },\r\n  };\r\n\r\n  constructor(\r\n    private activatedRoute: ActivatedRoute,\r\n    private router: Router,\r\n    private service: CourseManageService,\r\n    private modal: NzModalService,\r\n    private viewContainerRef: ViewContainerRef,\r\n    public cache: CacheService,\r\n    private message: NzMessageService,\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.activatedRoute.params.subscribe((res) => {\r\n      // 从路径获取课程id\r\n      this.getCourseDetail(res.id);\r\n    });\r\n  }\r\n\r\n  // 获取课程基础信息\r\n  getCourseDetail(id?: string) {\r\n    this.service.getCourseDetail(id ?? this.params.courseId).subscribe((res: any) => {\r\n      this.detailInfo = res[0] as CourseDetailInfo;\r\n      this.params = {\r\n        courseId: id ?? this.params.courseId,\r\n        weekTime: this.detailInfo.weekTime,\r\n      };\r\n      this.getCourseStudent();\r\n    });\r\n  }\r\n\r\n  // 获取课程学生信息\r\n  getCourseStudent() {\r\n    this.service.getCourseStudent(this.params.courseId).subscribe((res) => {\r\n      this.studentList = res as User[];\r\n    });\r\n  }\r\n\r\n  // 修改课程基础信息\r\n  editCourse(e: CourseAddInfo) {\r\n    let old: any = { ...this.detailInfo };\r\n    old.class = old.class?.map((item: any) => item.id);\r\n    if (\r\n      isEqual(e, ['class', 'description', 'endWeek', 'isCompulsory', 'name', 'startWeek', 'teacher', 'weekTime'], old, [\r\n        'class',\r\n        'description',\r\n        'endWeek',\r\n        'isCompulsory',\r\n        'courseName',\r\n        'startWeek',\r\n        'teacherId',\r\n        'weekTime',\r\n      ])\r\n    ) {\r\n      this.message.warning('信息未变动！');\r\n      return;\r\n    }\r\n    this.service.modifyCourseInfo({ ...e, courseId: this.params.courseId }).subscribe((res) => {\r\n      this.addCourseEl.close();\r\n      this.getCourseDetail();\r\n    });\r\n  }\r\n\r\n  onAllChecked(checked: boolean): void {\r\n    this.studentList.forEach(({ account }) => this.updateCheckedSet(account, checked));\r\n    this.refreshCheckedStatus();\r\n  }\r\n\r\n  // 添加/删除选中\r\n  updateCheckedSet(id: string, checked: boolean): void {\r\n    if (checked) {\r\n      this.setOfCheckedId.add(id);\r\n    } else {\r\n      this.setOfCheckedId.delete(id);\r\n    }\r\n  }\r\n\r\n  // 刷新全/半选状态\r\n  refreshCheckedStatus(): void {\r\n    this.checked = this.studentList.every(({ account }) => this.setOfCheckedId.has(account));\r\n    this.indeterminate = this.studentList.some(({ account }) => this.setOfCheckedId.has(account)) && !this.checked;\r\n  }\r\n\r\n  // 选中时更新集合刷新全半选状态\r\n  onItemChecked(id: string, checked: boolean): void {\r\n    this.updateCheckedSet(id, checked);\r\n    this.refreshCheckedStatus();\r\n  }\r\n\r\n  // 删除课程\r\n  deleteCourse() {\r\n    this.service.deleteCourse({ courseId: this.params.courseId }).subscribe((res) => {\r\n      this.router.navigateByUrl('/course-manage');\r\n    });\r\n  }\r\n\r\n  // 删除学生\r\n  deleteStudent() {\r\n    this.service\r\n      .deleteCourseStudent({ course_id: this.params.courseId, user_id: Array.from(this.setOfCheckedId) })\r\n      .subscribe((res) => {\r\n        this.getCourseStudent();\r\n      });\r\n  }\r\n\r\n  edit() {\r\n    if (this.editable) {\r\n      this.scheduleEl.saveEdit();\r\n    } else {\r\n      this.editable = true;\r\n    }\r\n  }\r\n\r\n  cancelEdit() {\r\n    this.editable = false;\r\n  }\r\n\r\n  // 切换单双周\r\n  weekTimeChange(e: number) {\r\n    this.params = {\r\n      courseId: this.params.courseId,\r\n      weekTime: e,\r\n    };\r\n  }\r\n}\r\n","<div class=\"view_scroll\">\r\n  <nz-page-header class=\"site-page-header\">\r\n    <nz-page-header-title>{{ detailInfo?.courseName }}</nz-page-header-title>\r\n    <nz-page-header-subtitle>{{ detailInfo?.isCompulsory === '是' ? '必修' : '选修' }}</nz-page-header-subtitle>\r\n    <nz-page-header-extra>\r\n      <button nz-button nzType=\"primary\" (click)=\"addCourseEl.open()\" *ngIf=\"cache.functionPermissions('editCourse')\">\r\n        编辑\r\n      </button>\r\n      <button\r\n        nz-button\r\n        nzDanger\r\n        nzType=\"primary\"\r\n        nz-popconfirm\r\n        nzPopconfirmTitle=\"确认删除?\"\r\n        nzOkText=\"确认\"\r\n        nzCancelText=\"取消\"\r\n        (nzOnConfirm)=\"deleteCourse()\"\r\n        *ngIf=\"cache.functionPermissions('deleteCourse')\"\r\n      >\r\n        删除\r\n      </button>\r\n    </nz-page-header-extra>\r\n    <nz-page-header-content>\r\n      <div class=\"content\">\r\n        <div class=\"main\">\r\n          <nz-descriptions nzSize=\"small\" [nzColumn]=\"2\">\r\n            <nz-descriptions-item nzTitle=\"教师\" [nzSpan]=\"1\">{{ detailInfo?.teacherName }}</nz-descriptions-item>\r\n            <nz-descriptions-item nzTitle=\"课程时间\" [nzSpan]=\"1\">\r\n              第 {{ detailInfo?.startWeek }}-{{ detailInfo?.endWeek }} 周\r\n            </nz-descriptions-item>\r\n            <nz-descriptions-item nzTitle=\"班级\" [nzSpan]=\"1\" *ngIf=\"detailInfo?.isCompulsory === '是'\">{{\r\n              (detailInfo?.class | textFrom) ?? '未设置班级...'\r\n            }}</nz-descriptions-item>\r\n            <nz-descriptions-item nzTitle=\"课程描述\" [nzSpan]=\"1\">{{\r\n              detailInfo?.description ?? '无课程描述...'\r\n            }}</nz-descriptions-item>\r\n          </nz-descriptions>\r\n        </div>\r\n        <div class=\"extra\">\r\n          <div>\r\n            <nz-statistic nzTitle=\"总节次\" [nzValue]=\"detailInfo?.count ?? '未设置课程表...'\"></nz-statistic>\r\n            <nz-statistic\r\n              nzTitle=\"学生人数\"\r\n              [nzValue]=\"detailInfo?.studentCount ?? '未导入学生...'\"\r\n              style=\"margin: 0 32px\"\r\n            ></nz-statistic>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nz-page-header-content>\r\n    <nz-page-header-footer>\r\n      <nz-tabset [nzSelectedIndex]=\"0\">\r\n        <nz-tab nzTitle=\"学生列表\">\r\n          <ng-template [ngTemplateOutlet]=\"studentListEl\"></ng-template>\r\n        </nz-tab>\r\n        <nz-tab nzTitle=\"课程表\">\r\n          <ng-template [ngTemplateOutlet]=\"courseScheduleEl\"></ng-template>\r\n        </nz-tab>\r\n      </nz-tabset>\r\n    </nz-page-header-footer>\r\n  </nz-page-header>\r\n</div>\r\n\r\n<!-- 学生列表 -->\r\n<ng-template #studentListEl>\r\n  <div class=\"flex-between my10\">\r\n    <span>\r\n      <button\r\n        nz-button\r\n        nzType=\"primary\"\r\n        (click)=\"addStudent.create(tplFooter)\"\r\n        *ngIf=\"cache.functionPermissions('addStudent')\"\r\n      >\r\n        添加学生\r\n      </button>\r\n      <!-- <button\r\n        nz-button\r\n        nzType=\"primary\"\r\n        style=\"margin-left: 10px\"\r\n        (click)=\"uploadDrawerEl.open()\"\r\n        *ngIf=\"cache.functionPermissions('courseImportStudent')\"\r\n      >\r\n        导入学生\r\n      </button> -->\r\n    </span>\r\n    <span>\r\n      <i\r\n        nz-icon\r\n        nzType=\"info-circle\"\r\n        nzTheme=\"twotone\"\r\n        nz-tooltip\r\n        nzTooltipPlacement=\"bottom\"\r\n        nzTooltipTitle=\"多选用户以执行批量操作\"\r\n        class=\"mr5\"\r\n        *ngIf=\"detailInfo?.isCompulsory === '否'\"\r\n      ></i>\r\n      <span class=\"reminder mr5\" *ngIf=\"detailInfo?.isCompulsory === '否' && setOfCheckedId.size\"\r\n        >已选中{{ setOfCheckedId.size }}人</span\r\n      >\r\n      <button\r\n        nz-button\r\n        nzDanger\r\n        nzType=\"primary\"\r\n        [disabled]=\"setOfCheckedId.size === 0\"\r\n        (click)=\"deleteStudent()\"\r\n        *ngIf=\"detailInfo?.isCompulsory === '否' && cache.functionPermissions('deleteStudent')\"\r\n      >\r\n        删除学生\r\n      </button>\r\n    </span>\r\n  </div>\r\n  <div class=\"view_scroll\">\r\n    <nz-table #userTable nzSize=\"small\" nzBordered [nzData]=\"studentList\">\r\n      <thead>\r\n        <tr>\r\n          <th\r\n            [nzChecked]=\"checked\"\r\n            [nzIndeterminate]=\"indeterminate\"\r\n            (nzCheckedChange)=\"onAllChecked($event)\"\r\n            *ngIf=\"detailInfo?.isCompulsory === '否'\"\r\n          ></th>\r\n          <th>学号</th>\r\n          <th>姓名</th>\r\n          <th>性别</th>\r\n          <th>学院</th>\r\n          <th>专业</th>\r\n          <th>班级</th>\r\n          <th>班主任</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr *ngFor=\"let data of userTable.data\">\r\n          <td\r\n            [nzChecked]=\"setOfCheckedId.has(data.account)\"\r\n            (nzCheckedChange)=\"onItemChecked(data.account, $event)\"\r\n            *ngIf=\"detailInfo?.isCompulsory === '否'\"\r\n          ></td>\r\n          <td>{{ data.account }}</td>\r\n          <td>{{ data.name }}</td>\r\n          <td>{{ data.gender }}</td>\r\n          <td>{{ data.college }}</td>\r\n          <td>{{ data.major }}</td>\r\n          <td>{{ data.class }}</td>\r\n          <td>{{ data.chargeTeacher }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </nz-table>\r\n  </div>\r\n</ng-template>\r\n\r\n<!-- 课程表 -->\r\n<ng-template #courseScheduleEl>\r\n  <div class=\"flex-between my10\">\r\n    <span>\r\n      <nz-radio-group\r\n        [ngModel]=\"params.weekTime\"\r\n        (ngModelChange)=\"weekTimeChange($event)\"\r\n        *ngIf=\"detailInfo?.weekTime === 1\"\r\n      >\r\n        <label nz-radio-button [nzValue]=\"1\">单周</label>\r\n        <label nz-radio-button [nzValue]=\"2\">双周</label>\r\n      </nz-radio-group>\r\n    </span>\r\n    <span>\r\n      <i\r\n        nz-icon\r\n        nzType=\"info-circle\"\r\n        nzTheme=\"twotone\"\r\n        nz-tooltip\r\n        nzTooltipPlacement=\"bottom\"\r\n        nzTooltipTitle=\"点击课表以 选中/取消选中 该节次\"\r\n        class=\"mr5\"\r\n        *ngIf=\"editable\"\r\n      ></i>\r\n      <button nz-button (click)=\"cancelEdit()\" *ngIf=\"editable\" class=\"mr5\">取消</button>\r\n      <button nz-button nzType=\"primary\" (click)=\"edit()\" *ngIf=\"cache.functionPermissions('editCourseSchedule')\">\r\n        {{ editable ? '保存编辑' : '编辑' }}\r\n      </button>\r\n    </span>\r\n  </div>\r\n  <schedule #scheduleEl [param]=\"params\" [editable]=\"editable\" (cancelEdit)=\"cancelEdit()\"></schedule>\r\n</ng-template>\r\n\r\n<!-- 修改课程抽屉 -->\r\n<add-course #addCourseEl (operation)=\"editCourse($event)\" operationText=\"修改\" [default]=\"detailInfo\"></add-course>\r\n\r\n<!-- 添加学生Modal Footer -->\r\n<ng-template #tplFooter let-ref=\"modalRef\">\r\n  <div>\r\n    <div class=\"flex-between\">\r\n      <span>已选中： {{ addStudent.instance.setOfCheckedId.size }} 人</span>\r\n      <div>\r\n        <button nz-button (click)=\"ref.destroy()\">取消</button>\r\n        <button nz-button nzType=\"primary\" (click)=\"addStudent.handleOk()\">确定</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<!-- TODO：导入学生抽屉 -->\r\n<upload-drawer #uploadDrawerEl url=\"\" templateUrl=\"\" errorUrl=\"\" title=\"导入学生\"></upload-drawer>\r\n","import { UserManageModule } from './../user-manage/user-manage.module';\nimport { Routes, RouterModule } from '@angular/router';\nimport { SharedModule } from './../../shared/shared.module';\nimport { NgModule } from '@angular/core';\nimport { CourseDetailComponent } from './course-detail.component';\n\nconst route: Routes = [{ path: '', component: CourseDetailComponent }];\n\n@NgModule({\n  imports: [SharedModule, RouterModule.forChild(route)],\n  declarations: [CourseDetailComponent],\n})\nexport class CourseDetailModule {}\n"],"sourceRoot":"webpack:///"}