{"version":3,"sources":["./src/app/pages/login/login.component.ts","./src/app/pages/login/login.component.html","./src/app/pages/login/login.module.ts","./src/app/pages/login/login.service.ts"],"names":[],"mappings":"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","file":"src_app_pages_login_login_module_ts.js","sourcesContent":["import { CacheService } from './../../core/services/cache.service';\r\nimport { CommonService } from '@app/core/services/common.service';\r\nimport { Router } from '@angular/router';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { validateForm } from '@shared/utils/utils';\r\nimport { LoginService } from './login.service';\r\nimport { environment } from '@env/environment';\r\nimport { _local, _session } from '@app/shared/utils/Storage';\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.scss'],\r\n  providers: [LoginService],\r\n})\r\nexport class LoginComponent implements OnInit {\r\n  systemName = environment.systemName;\r\n  loginForm!: FormGroup;\r\n  showPwd: Boolean = false;\r\n  avatarPath = environment.api;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private service: LoginService,\r\n    private router: Router,\r\n    private common: CommonService,\r\n    private cache: CacheService,\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loginForm = this.fb.group({\r\n      code: [null, [Validators.required]],\r\n      password: [_local.get('password'), [Validators.required]],\r\n      remember: [true],\r\n    });\r\n  }\r\n\r\n  login(): void {\r\n    validateForm(this.loginForm.controls);\r\n    if (this.loginForm.valid) {\r\n      const { code, password } = this.loginForm.value;\r\n      this.service.login({ code, password }).subscribe((res: any) => {\r\n        _local.set('token', res.token, res.expires);\r\n\r\n        this.common.getUserInfo().subscribe((res: any) => {\r\n          // 如果有头像，拼接头像完整地址\r\n          if (res.userInfo?.avatar) {\r\n            res.userInfo.avatar = this.avatarPath + res.userInfo.avatar;\r\n          }\r\n          _session.set('userInfo', res.userInfo);\r\n          _session.set('routes', res.routes);\r\n          _session.set('pagePermissions', res.pagePermissions);\r\n          _session.set('functionPermissions', res.functionPermissions);\r\n          this.cache.startCheckInInterval();\r\n          this.router.navigateByUrl('/index');\r\n        });\r\n      });\r\n    }\r\n  }\r\n}\r\n","<div class=\"view flex-center\" style=\"background-image: url('assets/images/login_background.jpg')\">\r\n  <div class=\"flex-center block\">\r\n    <div class=\"flex-center\">\r\n      <h1>{{ systemName }}</h1>\r\n      <form nz-form [formGroup]=\"loginForm\" class=\"login-form\">\r\n        <nz-form-item>\r\n          <nz-form-control nzErrorTip=\"帐号不能为空！\">\r\n            <nz-input-group nzPrefixIcon=\"user\">\r\n              <input type=\"text\" nz-input formControlName=\"code\" placeholder=\"请输入帐号\" />\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n        <nz-form-item>\r\n          <nz-form-control nzErrorTip=\"密码不能为空！\">\r\n            <nz-input-group nzPrefixIcon=\"lock\">\r\n              <input\r\n                [type]=\"showPwd ? 'text' : 'password'\"\r\n                nz-input\r\n                formControlName=\"password\"\r\n                placeholder=\"请输入密码\"\r\n              />\r\n              <i\r\n                nz-icon\r\n                [nzType]=\"showPwd ? 'eye' : 'eye-invisible'\"\r\n                nzTheme=\"outline\"\r\n                (click)=\"showPwd = !showPwd\"\r\n                class=\"flex-center\"\r\n              ></i>\r\n            </nz-input-group>\r\n          </nz-form-control>\r\n        </nz-form-item>\r\n        <div nz-row nzJustify=\"end\">\r\n          <span\r\n            class=\"reminder flex-center\"\r\n            nzTooltipTitle=\"请联系管理员重置密码\"\r\n            nzTooltipPlacement=\"bottom\"\r\n            nz-tooltip\r\n          >\r\n            <i nz-icon nzType=\"question-circle\" nzTheme=\"twotone\"></i>\r\n            忘记密码？\r\n          </span>\r\n        </div>\r\n        <button nz-button class=\"login-form-button\" [nzType]=\"'primary'\" (click)=\"login()\">登录</button>\r\n      </form>\r\n    </div>\r\n    <div class=\"flex-center\">\r\n      <img src=\"assets/images/login_illustrations.svg\" alt=\"机房管理系统\" />\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { SharedModule } from './../../shared/shared.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { LoginComponent } from './login.component';\r\nimport { RouterModule, Routes } from '@angular/router';\r\n\r\nconst route: Routes = [{ path: '', component: LoginComponent }];\r\n\r\n@NgModule({\r\n  imports: [SharedModule, RouterModule.forChild(route)],\r\n  declarations: [LoginComponent],\r\n})\r\nexport class LoginModule {}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Res } from '@app/shared/types/commonTypes';\r\n\r\n@Injectable()\r\nexport class LoginService {\r\n  constructor(private http: HttpClient) {}\r\n\r\n  login(data: object): any {\r\n    const url = '/user/login';\r\n    return this.http.post<Res>(url, data);\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}