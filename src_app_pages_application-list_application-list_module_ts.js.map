{"version":3,"sources":["./src/app/pages/application-list/application-list.component.ts","./src/app/pages/application-list/application-list.component.html","./src/app/pages/application-list/application-list.module.ts"],"names":[],"mappings":"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","file":"src_app_pages_application-list_application-list_module_ts.js","sourcesContent":["import { ActivatedRoute, Router } from '@angular/router';\r\nimport { ApplicationListService } from './application-list.service';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { ApplicationInfo, ApplicationParam } from '@app/shared/types/commonTypes';\r\nimport { NzTableQueryParams } from 'ng-zorro-antd/table';\r\nimport { ApplicationType, ApplicationStatus } from '@app/shared/enum/enum';\r\nimport * as base64 from 'js-base64';\r\nimport { base64Filter } from '@app/shared/utils/utils';\r\nimport { CacheService } from '@app/core/services/cache.service';\r\n\r\n@Component({\r\n  selector: 'app-application-list',\r\n  templateUrl: './application-list.component.html',\r\n  styleUrls: ['./application-list.component.scss'],\r\n  providers: [ApplicationListService],\r\n})\r\nexport class ApplicationListComponent implements OnInit {\r\n  type = ApplicationType;\r\n  status = ApplicationStatus;\r\n  listOfData: ApplicationInfo[] = []; // 列表数据\r\n  pageIndex = 1;\r\n  pageSize = 20;\r\n  total = 0;\r\n  param?: ApplicationParam;\r\n\r\n  constructor(\r\n    private service: ApplicationListService,\r\n    private router: Router,\r\n    private activatedRoute: ActivatedRoute,\r\n    public cache: CacheService,\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.activatedRoute.queryParams.subscribe((params: any) => {\r\n      if (params.param) {\r\n        const data = JSON.parse(base64.decode(params.param));\r\n        if (data.type !== undefined) {\r\n          this.type = ApplicationType.map((item) => {\r\n            item.byDefault = item.value === data.type;\r\n            return item;\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // 表格参数\r\n  onQueryParamsChange(e: NzTableQueryParams) {\r\n    this.param = e as unknown as ApplicationParam;\r\n    this.getApplicationList(e as unknown as ApplicationParam);\r\n  }\r\n\r\n  // 获取申请列表\r\n  getApplicationList(param: ApplicationParam) {\r\n    this.service.getApplicationList(param).subscribe((res: any) => {\r\n      this.listOfData = res.data as ApplicationInfo[];\r\n      this.total = res.total;\r\n    });\r\n  }\r\n\r\n  // 取消申请\r\n  cancelApply(id: string, type: number) {\r\n    const data = {\r\n      id,\r\n      type,\r\n    };\r\n    this.service.cancelApply(data).subscribe((res) => {\r\n      if (this.param) {\r\n        this.getApplicationList(this.param);\r\n      }\r\n    });\r\n  }\r\n\r\n  // 跳转详细\r\n  redirectDetail(type: number, id?: string) {\r\n    const param = base64Filter({ type, id });\r\n    this.router.navigate(['/apply'], { queryParams: { param } });\r\n  }\r\n}\r\n","<div class=\"layout\">\r\n  <div class=\"header\">\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      class=\"mr10\"\r\n      (click)=\"redirectDetail(0)\"\r\n      *ngIf=\"cache.functionPermissions('labApply')\"\r\n    >\r\n      机房申请\r\n    </button>\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      class=\"mr10\"\r\n      (click)=\"redirectDetail(1)\"\r\n      *ngIf=\"cache.functionPermissions('shopApply')\"\r\n    >\r\n      采购申请\r\n    </button>\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      class=\"mr10\"\r\n      (click)=\"redirectDetail(2)\"\r\n      *ngIf=\"cache.functionPermissions('repairApply')\"\r\n    >\r\n      报修申请\r\n    </button>\r\n  </div>\r\n  <div class=\"container\">\r\n    <div class=\"view_scroll padding\">\r\n      <nz-table\r\n        #applicationTable\r\n        [nzData]=\"listOfData\"\r\n        nzTableLayout=\"fixed\"\r\n        nzSize=\"small\"\r\n        [nzFrontPagination]=\"false\"\r\n        [nzTotal]=\"total\"\r\n        [(nzPageIndex)]=\"pageIndex\"\r\n        [(nzPageSize)]=\"pageSize\"\r\n        [nzShowSizeChanger]=\"true\"\r\n        (nzQueryParams)=\"onQueryParamsChange($event)\"\r\n      >\r\n        <thead>\r\n          <tr>\r\n            <th nzWidth=\"100px\" nzColumnKey=\"status\" [nzFilters]=\"status\" [nzFilterFn]=\"true\">申请状态</th>\r\n            <th nzWidth=\"100px\" nzColumnKey=\"type\" [nzFilters]=\"type\" [nzFilterFn]=\"true\">申请类型</th>\r\n            <th nzWidth=\"170px\">申请人</th>\r\n            <th\r\n              nzWidth=\"170px\"\r\n              nzColumnKey=\"time\"\r\n              [nzSortFn]=\"true\"\r\n              [nzSortDirections]=\"['ascend', 'descend']\"\r\n              nzSortOrder=\"descend\"\r\n            >\r\n              申请时间\r\n            </th>\r\n            <th>备注</th>\r\n            <th nzAlign=\"center\" nzWidth=\"220px\">操作</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr *ngFor=\"let data of applicationTable.data\">\r\n            <td>{{ status[data.status].text }}</td>\r\n            <td>{{ type[data.type].text }}</td>\r\n            <td>{{ data.user_id }}-{{ data.user_name }}</td>\r\n            <td>{{ data.time }}</td>\r\n            <td nz-typography nzEllipsis>{{ data.remark }}</td>\r\n            <td nzAlign=\"center\">\r\n              <button nz-button nzType=\"link\" (click)=\"redirectDetail(data.type, data.id)\">查看详细</button>\r\n              <button\r\n                nz-button\r\n                nzType=\"link\"\r\n                nz-popconfirm\r\n                nzPopconfirmTitle=\"确认取消申请?\"\r\n                (nzOnConfirm)=\"cancelApply(data.id, data.type)\"\r\n                nzPopconfirmPlacement=\"bottom\"\r\n                *ngIf=\"data.status !== 5\"\r\n              >\r\n                取消申请\r\n              </button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </nz-table>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { RouterModule, Routes } from '@angular/router';\r\nimport { SharedModule } from './../../shared/shared.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { ApplicationListComponent } from './application-list.component';\r\n\r\nconst route: Routes = [{ path: '', component: ApplicationListComponent }];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(route), SharedModule],\r\n  declarations: [ApplicationListComponent],\r\n})\r\nexport class ApplicationListModule {}\r\n"],"sourceRoot":"webpack:///"}