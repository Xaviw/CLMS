{"version":3,"sources":["./src/app/pages/lab-manage/lab-card/lab-card.component.ts","./src/app/pages/lab-manage/lab-card/lab-card.component.html","./src/app/pages/lab-manage/lab-manage.component.ts","./src/app/pages/lab-manage/lab-manage.component.html","./src/app/pages/lab-manage/lab-manage.module.ts"],"names":[],"mappings":"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","file":"src_app_pages_lab-manage_lab-manage_module_ts.js","sourcesContent":["import { CommonService } from '@app/core/services/common.service';\r\nimport { LabManageService } from './../lab-manage.service';\r\nimport { Component, Input, OnInit, ViewChild, ElementRef, Output, EventEmitter, TemplateRef } from '@angular/core';\r\nimport { LabInfo } from '@app/shared/types/commonTypes';\r\nimport { LabStatus } from '@app/shared/enum/enum';\r\nimport { CacheService } from '@app/core/services/cache.service';\r\n\r\n@Component({\r\n  selector: 'lab-card',\r\n  templateUrl: './lab-card.component.html',\r\n  styleUrls: ['./lab-card.component.scss'],\r\n  providers: [LabManageService],\r\n})\r\nexport class LabCardComponent implements OnInit {\r\n  // 卡片封面\r\n  @ViewChild('labCoverEl') labCoverEl!: ElementRef;\r\n  // 数据\r\n  @Input() labInfo!: LabInfo;\r\n  // 刷新\r\n  @Output() refresh: EventEmitter<any> = new EventEmitter();\r\n  // 状态枚举\r\n  labStatus = LabStatus;\r\n\r\n  constructor(private service: LabManageService, private common: CommonService, public cache: CacheService) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  tag(a: TemplateRef<any>, b: TemplateRef<any>, c: TemplateRef<any>): TemplateRef<any>[] {\r\n    if (this.cache.functionPermissions('deleteLab') && this.cache.functionPermissions('setLabStatus')) {\r\n      return [a, b, c];\r\n    } else if (this.cache.functionPermissions('deleteLab')) {\r\n      return [a, b];\r\n    } else if (this.cache.functionPermissions('setLabStatus')) {\r\n      return [a, c];\r\n    } else {\r\n      return [a];\r\n    }\r\n  }\r\n\r\n  // 删除机房\r\n  deleteLab() {\r\n    this.service.deleteLab(this.labInfo.id).subscribe((res) => {\r\n      this.refresh.emit();\r\n    });\r\n  }\r\n\r\n  // 设置机房状态\r\n  setLabStatus(status: LabStatus) {\r\n    this.common.setLabStatus({ labIds: [this.labInfo.id], status }).subscribe((res) => {\r\n      this.refresh.emit();\r\n    });\r\n  }\r\n}\r\n","<nz-card style=\"width: 100%\" [nzCover]=\"coverTemplate\" [nzActions]=\"tag(viewDetail, delete, setStatus)\">\r\n  <nz-tag nzColor=\"green\" class=\"status-tag\" *ngIf=\"labInfo?.status === labStatus.open\">开放中</nz-tag>\r\n  <nz-tag nzColor=\"red\" class=\"status-tag\" *ngIf=\"labInfo?.status === labStatus.close\">未开放</nz-tag>\r\n  <nz-tag nzColor=\"gray\" class=\"status-tag\" *ngIf=\"labInfo?.status === labStatus.repair\">维修中</nz-tag>\r\n  <div class=\"flex-between\">\r\n    <nz-card-meta\r\n      [nzTitle]=\"labInfo?.name ?? ''\"\r\n      [nzDescription]=\"labInfo?.description ?? '无描述...'\"\r\n      style=\"position: relative\"\r\n    ></nz-card-meta>\r\n    <div class=\"flex-center\" style=\"flex-direction: column\">\r\n      <span *ngIf=\"labInfo?.capacity\" style=\"margin-bottom: 8px\">容量：{{ labInfo?.capacity }}人</span>\r\n      <span *ngIf=\"labInfo?.isFree !== undefined\" nz-typography nzType=\"secondary\">{{\r\n        labInfo?.isFree ? '当前空闲' : '当前有课'\r\n      }}</span>\r\n    </div>\r\n  </div>\r\n</nz-card>\r\n<ng-template #coverTemplate>\r\n  <div\r\n    class=\"cover\"\r\n    [style.background-image]=\"\r\n      'url(' + (labInfo?.image?.length ? labInfo.image![0] : 'assets/images/login_background.jpg') + ')'\r\n    \"\r\n  ></div>\r\n</ng-template>\r\n<ng-template #viewDetail>\r\n  <button nz-button nzType=\"link\" nzSize=\"small\" [routerLink]=\"['/lab-manage', labInfo.id]\">查看详细</button>\r\n</ng-template>\r\n\r\n<ng-template #delete>\r\n  <button\r\n    nz-button\r\n    nzType=\"link\"\r\n    nzDanger\r\n    nzSize=\"small\"\r\n    nz-popconfirm\r\n    nzPopconfirmTitle=\"确认删除该机房?\"\r\n    (nzOnConfirm)=\"deleteLab()\"\r\n    nzPopconfirmPlacement=\"bottom\"\r\n  >\r\n    删除机房\r\n  </button>\r\n</ng-template>\r\n\r\n<ng-template #setStatus>\r\n  <button nz-button nzType=\"link\" nzSize=\"small\" nz-dropdown [nzDropdownMenu]=\"menu\" nzPlacement=\"bottomCenter\">\r\n    设置状态\r\n  </button>\r\n  <nz-dropdown-menu #menu=\"nzDropdownMenu\">\r\n    <ul nz-menu>\r\n      <li nz-menu-item (click)=\"setLabStatus(labStatus.open)\">开放中</li>\r\n      <li nz-menu-item (click)=\"setLabStatus(labStatus.close)\">未开放</li>\r\n      <li nz-menu-item (click)=\"setLabStatus(labStatus.repair)\">维修中</li>\r\n    </ul>\r\n  </nz-dropdown-menu>\r\n</ng-template>\r\n","import { CommonService } from '@app/core/services/common.service';\r\nimport { validateForm } from '@shared/utils/utils';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { LabManageService } from './lab-manage.service';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { LabInfo } from '@app/shared/types/commonTypes';\r\nimport { CacheService } from '@app/core/services/cache.service';\r\n\r\n@Component({\r\n  selector: 'lab-manage',\r\n  templateUrl: './lab-manage.component.html',\r\n  styleUrls: ['./lab-manage.component.scss'],\r\n  providers: [LabManageService],\r\n})\r\nexport class LabManageComponent implements OnInit {\r\n  labList: LabInfo[] = [];\r\n  // 添加机房抽屉\r\n  addLabDrawer = {\r\n    visible: false,\r\n    formGroup: this.fb.group({\r\n      name: [null, [Validators.required]],\r\n      description: [null],\r\n    }),\r\n    cancel() {\r\n      this.formGroup.reset();\r\n      this.visible = false;\r\n    },\r\n    handleOk: () => {\r\n      validateForm(this.addLabDrawer.formGroup.controls);\r\n      if (this.addLabDrawer.formGroup.valid) {\r\n        this.service.addLab(this.addLabDrawer.formGroup.getRawValue()).subscribe((res) => {\r\n          this.addLabDrawer.cancel();\r\n          this.getLabList();\r\n        });\r\n      }\r\n    },\r\n  };\r\n\r\n  constructor(\r\n    private service: LabManageService,\r\n    private fb: FormBuilder,\r\n    private common: CommonService,\r\n    public cache: CacheService,\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.getLabList();\r\n  }\r\n\r\n  // 获取机房列表\r\n  getLabList() {\r\n    this.common.getLabList().subscribe((res) => {\r\n      this.labList = res as LabInfo[];\r\n    });\r\n  }\r\n}\r\n","<div class=\"view_scroll padding\">\r\n  <div class=\"my10\" style=\"overflow: auto\">\r\n    <button\r\n      nz-button\r\n      nzType=\"primary\"\r\n      style=\"float: right\"\r\n      (click)=\"addLabDrawer.visible = true\"\r\n      *ngIf=\"cache.functionPermissions('addLab')\"\r\n    >\r\n      添加机房\r\n    </button>\r\n  </div>\r\n  <div class=\"card-area\" empty [emptyData]=\"labList\" emptyInfo=\"没有机房信息...\">\r\n    <lab-card class=\"card\" *ngFor=\"let lab of labList\" [labInfo]=\"lab\" (refresh)=\"getLabList()\"></lab-card>\r\n    <!-- 占位空标签，用于flex对齐 -->\r\n    <div class=\"card\"></div>\r\n    <div class=\"card\"></div>\r\n    <div class=\"card\"></div>\r\n    <div class=\"card\"></div>\r\n    <div class=\"card\"></div>\r\n    <div class=\"card\"></div>\r\n  </div>\r\n</div>\r\n\r\n<!-- 添加机房抽屉 -->\r\n<nz-drawer\r\n  nzWidth=\"300px\"\r\n  [nzClosable]=\"false\"\r\n  [nzVisible]=\"addLabDrawer.visible\"\r\n  nzPlacement=\"right\"\r\n  [nzFooter]=\"footerTpl\"\r\n  nzTitle=\"添加机房\"\r\n  (nzOnClose)=\"addLabDrawer.visible = false\"\r\n>\r\n  <ng-container *nzDrawerContent>\r\n    <form nz-form [formGroup]=\"addLabDrawer.formGroup\" nzLayout=\"vertical\">\r\n      <nz-form-item>\r\n        <nz-form-label nzFor=\"name\" nzRequired>机房名称：</nz-form-label>\r\n        <nz-form-control nzErrorTip=\"机房名称不能为空！\">\r\n          <input nz-input formControlName=\"name\" id=\"name\" placeholder=\"请输入机房名称\" />\r\n        </nz-form-control>\r\n      </nz-form-item>\r\n      <nz-form-item>\r\n        <nz-form-label nzFor=\"description\">机房描述：</nz-form-label>\r\n        <nz-form-control>\r\n          <input nz-input formControlName=\"description\" id=\"description\" placeholder=\"请输入机房描述\" />\r\n        </nz-form-control>\r\n      </nz-form-item>\r\n    </form>\r\n  </ng-container>\r\n  <ng-template #footerTpl>\r\n    <div style=\"float: right\">\r\n      <button nz-button style=\"margin-right: 8px\" (click)=\"addLabDrawer.cancel()\">取消</button>\r\n      <button nz-button nzType=\"primary\" (click)=\"addLabDrawer.handleOk()\">添加</button>\r\n    </div>\r\n  </ng-template>\r\n</nz-drawer>\r\n","import { LabCardComponent } from './lab-card/lab-card.component';\r\nimport { SharedModule } from './../../shared/shared.module';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { NgModule } from '@angular/core';\r\nimport { LabManageComponent } from './lab-manage.component';\r\n\r\nconst route: Routes = [{ path: '', component: LabManageComponent }];\r\n\r\n@NgModule({\r\n  imports: [SharedModule, RouterModule.forChild(route)],\r\n  declarations: [LabManageComponent, LabCardComponent],\r\n})\r\nexport class LabManageModule {}\r\n"],"sourceRoot":"webpack:///"}